\documentclass{article}
\usepackage[most]{tcolorbox}
\usepackage[a4paper,top=1in, bottom=1.25in, left=1.25in, right=1.25in]{geometry}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{capt-of}
\usepackage{graphicx}
\usepackage{caption,subcaption}
\usepackage{url}
\usepackage{multirow}
\usepackage{enumerate}
%\usepackage{tikz}
\usepackage{epstopdf}% To incorporate .eps illustrations using PDFLaTeX, etc.
%\usepackage{subfigure}% Support for small, `sub' figures and tables
\usepackage{nameref}
\usepackage{zref-xr,zref-user}
\zxrsetup{toltxlabel=true, tozreflabel=false}
%\zexternaldocument*[original:]{TSC}
\usepackage{xcite}
\usepackage{hyperref}
\usepackage{ulem}
\usepackage{bm}
\usepackage{optidef}
%\externalcitedocument[org:]{TSC}

%\usepackage[table]{xcolor}
%\usepackage{color}
%\usepackage{colortbl}

\definecolor{Gray}{gray}{0.9}
\newcommand{\coldscr}{\cellcolor{Gray}}

\newcommand{\initresponses}{\newcounter{pointcounter}}

\newenvironment{reviewer}{\setcounter{pointcounter}{1}}{}

\newenvironment{mybiblio}{\small}{}


%\newcommand{\point}{{\textsl{\thepointcounter}. \stepcounter{pointcounter} #1}}

%\newcommand{\point}[1]{\medskip \noindent \text{{\selectfont \thepointcounter} \stepcounter{pointcounter} #1}}

\newcommand{\point}{\text{{\selectfont \thepointcounter} \stepcounter{pointcounter}}}


\newcommand{\mynum}[1]{^{(#1)}}
\newcommand{\myi}{\mynum{i}}
\newcommand{\mym}{\mynum{m}}
\newcommand{\mymi}{\mynum{m,i}}
\newcommand{\myMi}{\mynum{M,i}}
\newcommand{\myq}{\mynum{q,i}}
\newcommand{\myzeroi}{\mynum{0,i}}
\newcommand{\myduei}{^{(i)\;2}}
\newcommand{\JP}[1]{{\color{blue}#1}}
\newcommand{\LA}[1]{{\color{red}#1}}
\newcommand{\TP}[1]{{\color{orange}#1}}
\begin{comment}
	\usetikzlibrary{shapes.geometric,backgrounds,
		positioning-plus,node-families,calc}
	\tikzset{
		basic box/.style = {
			shape = rectangle,
			align = center,
			draw  = #1,
			fill  = #1!25,
			rounded corners},
		header node/.style = {
			Minimum Width = 0.4cm,
			font          = \strut\scriptsize\ttfamily,
			text depth    = +0pt,
			fill          = white,
			draw},
		header/.style = {%
			inner ysep = +1.5em,
			append after command = {
				\pgfextra{\let\TikZlastnode\tikzlastnode}
				node [header node] (header-\TikZlastnode) at (\TikZlastnode.north) {#1}
				node [span = (\TikZlastnode)(header-\TikZlastnode)]
				at (fit bounding box) (h-\TikZlastnode) {}
			}
		},
		hv/.style = {to path = {-|(\tikztotarget)\tikztonodes}},
		vh/.style = {to path = {|-(\tikztotarget)\tikztonodes}},
		fat blue line/.style = {ultra thick, blue}
	}
	
	\tikzstyle{dummy} = [rectangle, text width=0.1em, draw=white, white,
	minimum width=0.1em, minimum height=3em, opacity=0.0]
	
	\tikzstyle{mycircle} = [circle, draw=black, black, text width=1em, minimum height=1em]
	
	\tikzstyle{mydiamond} = [diamond, aspect=2, draw=gray, fill=gray!25, text width=6em, minimum height=1em]
	
	\tikzstyle{startend} =  [rectangle, font=\strut\scriptsize\ttfamily, text depth=+0pt, fill=white, draw=black]
\end{comment}

\hyphenation{dif-fe-rent}

\title{CAIE-D-23-00610
	\\
	"The Hampered Travelling Salesman Problem with Neighbourhoods"}
\author{Answer to Reviewers' Comments}
\begin{document}
	\maketitle
	%\begin{abstract}
	%\todo[inline,color=green!50]
	%{Abstract changed to adapt to format indicated in
		%guidelines to authors. Text has beeen changed to
		%reflect the update of Section 2 and Discussion.}
	%\lipsum[1]
	%\end{abstract}
	%\section{Introduction}
	%Really et al. (2010)
	%\todo[color=blue!40]{Added citation}
	%said some important suff.\lipsum[2]
	%\lipsum[3]
	
	We wish to thank the editors and reviewers for their valuable comments and advices which allowed us to further improve the quality and presentation of our article through this revision.
	
	We revised the manuscript taking into account all the suggestions of Reviewers 1 and 2. We highlighted in blue all the changes in the revised manuscript. In the following, we report our changes inside the coloured textboxes.
	%{\bf We outlined in bold each change made in this new version of the paper}.
	\initresponses
	
	\begin{reviewer}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=red!75!black,colframe=red!75!black,borderline={1pt}{0pt}{black},boxrule=0pt]
			\textbf{Reviewer 1}
		\end{tcolorbox}
		
		\begin{itshape}
			This is an interesting and difficult problem. There are, however, many parts
			expressed in vague terms. Furthermore, the authors often rely on results from the
			literature. I think these results need to be stated and their interpretation has to be
			explicitly written in the studied framework , not by just citing references.
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=red!5!white,colframe=red!75!black,title=\textbf{Answer R1.\point},borderline={1pt}{0pt}{black},boxrule=0pt]

		\end{tcolorbox}
		
		\begin{itshape}
			Assumption A3: Which kind of union is operated between two overlapping barriers. Is it a convex union? But in case of segments, the resulting barrier is not a segment!
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=red!5!white,colframe=red!75!black,title=\textbf{Answer R1.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
		It is considered as an standard union of segments. So that 2 intersecting segments may give rise to 4 different ones considering the intersection point as one of the  endpoints of all of them. If the two segment overlap them the union is the resulting segment.
		\end{tcolorbox}
		
		\begin{itshape}
			Second Order Cone seems to be an important property but here a very few information is given about it. Please, try to give more details in Subsection 3.1 (definition, properties...)
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=red!5!white,colframe=red!75!black,title=\textbf{Answer R1.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
			Done.
		\end{tcolorbox}
		
		\begin{itshape}
			Page 14: The first sentence is about computing the dominating sets, the construction algorithm must be specified.
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=red!5!white,colframe=red!75!black,title=\textbf{Answer R1.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
		In Page 13, we have rewritten this paragraph to state clearly how the dominating sets are built. The new paragraph is:
		
		\medskip
		
		Therefore, we can compute, \textit{`a priori'},  the sets $N_X^*$, $X\in\{S,T\}$. For each $P_B^i\in V_{\mathcal B}$, the corresponding point in the source neighbourhood $P_X(P_B^i)$ is computed by solving the following convex problem:
		\begin{argmini*}
			{P_X\in N_X}{d(P_XP_B^i)}
			{}{P_X(P_B^i)=}\label{eq:computing_n}\tag{$N_X^*$}
			\addConstraint{(\alpha-C),(\beta-C),(\gamma-C),(\delta-C),}{\quad\forall P_B^1, P_B^2\in V_\mathcal B}
			\addConstraint{(\varepsilon-C)}{}
			\addConstraint{\varepsilon(P_XP_B^i)=1}
			\addConstraint{	\|P_X - P_B^i\|\leq d(P_XP_B^i).}{}
		\end{argmini*}
		
		Then, the visibility graph is constructed by means of these dominating sets.
		This graph, required to address the new formulation, uses the previous graph $G_{\text{SPP}}$ in which we increase the new edges that connect the initial and terminal points $P_S\in N_S$ and $P_T\in N_T$, respectively, with the corresponding points in $N_S^*$ and $N_T^*$. Moreover, we also augment the edges connecting the points in the dominating sets with the extreme points of the segments where the minimal distances are attained. The reader may note that since the optimisation model minimises the overall distance, in an optimal solution $P_S$ must belong to $N_S^*$ and $P_T$ to $N_T^*$.
			

		\end{tcolorbox}
		
		\begin{itshape}
			The single-commodity flow formulation is considered for the Steiner Travelling salesman
			problem for two reasons: the fictitious vertices associated to barriers and the shortest path
			problem formulation. This is an example where the explanation of this motivation is scattered
			throughout many paragraphs. Try to summerize and to shorten the text.
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=red!5!white,colframe=red!75!black,title=\textbf{Answer R1.\point},borderline={1pt}{0pt}{black},boxrule=0pt]

		\end{tcolorbox}
		
		\begin{itshape}
			Page 20: The difference between H-TSPHN and H-TSPN is given but the authors have to describe the $\alpha$-constraints, specially the product of continuous variables obtained for this case.
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=red!5!white,colframe=red!75!black,title=\textbf{Answer R1.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
		In Page 10, we have described the difference between these formulations in terms of the $\alpha$ constraints by including the following paragraph:
		
		\medskip
		
		The fact of considering the possibility of going directly from one to other neighbourhood leads to include product of continuous variables in the determinants of these constraints of the model. These products make the H-TSPN to become non-convex. However, in the H-TSPHN, since two of the three arguments of each determinant are fixed, the $\alpha$ constraints become linear. It motivates the comparison between two formulations in terms of computational cost of considering the more general version, studied in Section 5.
		\end{tcolorbox}
		
		
		\begin{itshape}
			\underline{Minor corrections:}
			\begin{itemize}
				\item \textbf{Page 3:} 
				\begin{itemize}
					\item 2nd paragraph, last line : ``obStacles''.
					\item last paragraph: 6 sections.
				\end{itemize}
				\item \textbf{Page 5:} Use ``endnodes'' of an edge instead of vertices.
				\item \textbf{Page 11:} 
				\begin{itemize} 
					\item In the definition of $E_X$ replace $\wedge$ by a comma.
					\item Figures 1 and 2: add a), b), c) for each case.
				\end{itemize}
				\item \textbf{Page 12:} In the mathematical formulation: the last of constraints is ($N$-C) or ($U$-C)? Make it clear.
				\item \textbf{Page 23}: Figure 7: Keep the same notation as in the algorithm 1: barrier $B_1$ and corresponding points denoted $P^1_{B_1}$ instead of $P^1_1$ for example. 
				\item \textbf{Page 27}: 
				\begin{itemize}
					\item Proof of Proposition 6: Define exactly the visibility graph, its vertices and edges.
					\item Algorithm 3: Is step 2 defined by Algorithm 4? same thing for step 3 and Algorithm 5? Explain the connections between the different algorithms.
				\end{itemize}
				\item \textbf{Page 29}:
				\begin{itemize}
					\item In the second experiment, the number of instances is ten, isn’t it?
					\item Indicate that the unit time is the second.
					\item Tables 2 and 3, column $|\mathcal B|$: are the values average?
				\end{itemize}
			\end{itemize}
			
		\end{itshape}

		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=red!5!white,colframe=red!75!black,title=\textbf{Answer R1.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
			\begin{itemize}
				\item \textbf{Page 3:} Corrected both typos.
				\item \textbf{Page 5:} ``Endnodes'' are used instead of vertices.
				\item \textbf{Page 11:} Done.
				\item \textbf{Page 12:} ($N$-C) is used in the formulations for the sake of simplicity, as exposed in the first paragraph of Page 10.
				\item \textbf{Page 23}: Corrected.
				\item \textbf{Page 27}: 
				\begin{itemize}
					\item A definition of visibility graphs is included in Page 5 before describing these objects for each problem studied in the manuscript.
					\item After Algorithm 3, in Page 26, a paragraph connecting Algorithms 4 and 5 with steps 2 and 3, is included.
				\end{itemize}
				\item \textbf{Page 29}:
				\begin{itemize}
					\item Yes. We have corrected the typo to say that the number instances for each setting is ten.
					\item Done.
					\item Yes. In the configuration of the experiments, we specify that \boldsymbol{$|\mathcal B|$} represents the average number of barriers for each setting.
				\end{itemize}
			\end{itemize}
		\end{tcolorbox}
		
	\end{reviewer}
	
	\newpage
	\begin{reviewer}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=green!75!black,colframe=green!75!black,borderline={1pt}{0pt}{black},boxrule=0pt]
			\textbf{Reviewer 2}
		\end{tcolorbox}
		
		\begin{itshape}
			This article deals with the study of variants of the TSP: the TSP with consideration of neighbourhoods and barriers. According to the authors, this is the first time that this variant of the problem has been studied. This variant of the TSP is far removed from the original problem. It is sufficient to pass close to a city to visit it (in its neighbourhood) and there are obstacles or barriers (in the form of impassable segments) that require detours to get from one point to another. This study is particularly motivated by surveillance or distribution applications using drones.
			
			The paper is structured in 6 parts and studies three variants: the H-SPPN (Hampered Shortest Path Problem with Neighbourhoods), the H-TSPHN (Hampered Traveling Salesman Problem with Hidden Neighbourhoods) and the H-TSPN (Hampered Traveling Salesman Problem with Neighbourhoods), which is a relaxed form of the previous one.
			
			Overall, this article is of an excellent scientific standard. It presents a mathematical model of the three variants, a proof of their complexity (the first variant is polynomial, the second and therefore the third are NP-complete), a strengthening of the mathematical formulations and a comprehensive experimental study that demonstrates the effectiveness of the approach adopted. I recommend that the paper be accepted, considering the minor remarks made in the more detailed comments that follow.
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=green!5!white,colframe=green!75!black,title=\textbf{Answer R2.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
		We thank the referee for his/her positive evaluation which we appreciate very much.
			
		\end{tcolorbox}
		
		\begin{itshape}
			Section 1 is a long introduction in which the variants considered are presented and positioned in relation to the literature. The state of the art seems complete and is well structured. The authors make an effort to illustrate their problem with concrete potential applications, which is much appreciated. The presentation of the plan mistakenly mentions that the article is structured in 8 sections instead of 6.
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=green!5!white,colframe=green!75!black,title=\textbf{Answer R2.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
		This was a type that came from an earlier organization of the paper. It has been fixed in this revision.

		\end{tcolorbox}
		
		\begin{itshape}
			Section 2 introduces important preliminary notions and notations that will be used in the remainder of the paper. The three problems are represented in the form of a graph whose vertices are points chosen from the neighbourhoods or the endpoints of the barriers, and the edges connect two vertices provided that they do not intersect any obstacles. The graphs for the three problems are presented separately, which makes them easier and clearer to read. The beginning of section 2 (presentation of hypotheses and notations) can be numbered within a sub-section 2.1.
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=green!5!white,colframe=green!75!black,title=\textbf{Answer R2.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
		Done.

		\end{tcolorbox}
		
		\begin{itshape}
			Section 3 is a very long section (pages 7 to 20) devoted to modelling problems in the form of a mixed nonlinear programme (MINLP). This is the heart of the article. This part is very well written, and the reader is led progressively through the modelling of the various problems and the proof of their complexity. Well-chosen figures illustrate the subject and make it easier to understand.
		\end{itshape}


		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=green!5!white,colframe=green!75!black,title=\textbf{Answer R2.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
			We thank again the referee for his/her positive  appreciation.
		\end{tcolorbox}
		
		\begin{itshape}
			Section 4 strengthens the formulation presented in the previous section by focusing on three proposals: removing unnecessary edges, adjusting the value of big-M, and fixing some variables. The results presented in the next section will show the interest of these strengthening. It might be interesting to know the marginal contribution of each of these proposals to improving the solver's behaviour.
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=green!5!white,colframe=green!75!black,title=\textbf{Answer R2.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
			In order to show the usefulness of our strengthenings we have designed a pilot computational study choosing a representative type of problem with 10 neighbouhoods and an average number of 18 barriers and we have compared the gaps obtained by the solver using the formulation and each one of the proposed improvements. These new results are gathered in table zzz.
		\end{tcolorbox}
		
		\begin{itshape}
			The results are presented in section 5. The datasets are presented first, with two classes of instances. The first is completely generated and contains instances of 20 to 100 neighbourhoods to visit. The second is generated using instances from the literature for the "close-enough TSP", and adding obstacles. The results show the effectiveness of the solver (and also its limitations)
			\begin{itemize}
			\item I invite the authors to make the instances they have generated available to the community.
			\item It might be interesting to build an (or several) instance(s) from a real city map.
			\item It might be interesting for the reader to visualise an optimal solution
			\end{itemize}
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=green!5!white,colframe=green!75!black,title=\textbf{Answer R2.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
		\begin{itemize}
			\item The instancesare available at XXX
			\item We have included a case study  from a real neighbourhood of the city map of Cordoba in the south of Spain .
			\item  The reader to visualise an optimal solution of the considered problems in Figure YYY
			\end{itemize}
			
		\end{tcolorbox}
		
		\begin{itshape}
			The conclusion gives both theoretical and practical perspectives to this work.
		\end{itshape}
		
		\begin{itshape}
			A general comment: The H-SPPN is a polynomial variant that is not considered at all in the experimental part. At the end of the reading, I did not understand the interest of this variant and its contribution to the solution of the two other variants. I recommend that the authors improve or better explain how knowing how to solve the H-SPPN can help to solve the two other problems.
		\end{itshape}
		
		\begin{tcolorbox}[breakable,enhanced,coltitle=black,colback=green!5!white,colframe=green!75!black,title=\textbf{Answer R2.\point},borderline={1pt}{0pt}{black},boxrule=0pt]
			The H-SPPN is an important building block to construct more complex models. In many network design and location problems the underlying problem is to compute shortest paths between entities (point in location problems, origin-destination pairs in hub location, routes in vehicle routing ...)
 Developing valid formulations for the H-SPPN problem allows one to formulate and solve for instance the H-TSPN or facility location problems with neighbouhoods and barriers which could not be considered otherwise since no exact polynomial time combinatorial algorithms exist for these problems (already NP-hard).
 		\end{tcolorbox}
		
	\end{reviewer}
	
	
\end{document}
